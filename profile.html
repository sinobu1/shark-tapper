<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#0a0a2a" />
    <title>–ê–∫—É–ª–∞ –¢–∞–ø–∞–ª–∫–∞ - –ü—Ä–æ—Ñ–∏–ª—å</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/stylesmain.css">
  
    <link href="css/profile.css" rel="stylesheet" />

    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <script type="module" src="js/main.js"></script>
  </head>
  <body>
    <!-- –ü–ª–∞–≤–∞—é—â–∏–µ —á–∞—Å—Ç–∏—Ü—ã –Ω–∞ —Ñ–æ–Ω–µ -->
    <div class="particles" id="particles"></div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –∏–≥—Ä–æ–≤—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º -->
    <div class="container">
      <!-- –ë–ª–æ–∫ –≤–∞–ª—é—Ç—ã -->
      <div class="currency">
        <span>
          <img
            src="https://raw.githubusercontent.com/sinobu1/shark-tapper/main/coin.png"
            alt="–ò–∫–æ–Ω–∫–∞ –º–æ–Ω–µ—Ç—ã"
          />
          <span id="coin-count" class="coin-count">0</span>
        </span>
        <span>
          <img
            src="https://raw.githubusercontent.com/sinobu1/shark-tapper/main/dimond.png"
            alt="–ò–∫–æ–Ω–∫–∞ –∞–ª–º–∞–∑–∞"
            class="gem-icon"
          />
          <span id="gem-count" class="gem-count">0</span>
        </span>
        <span>
          <img
            src="https://raw.githubusercontent.com/sinobu1/shark-tapper/main/ruda.png"
            alt="–ò–∫–æ–Ω–∫–∞ —Ä—É–¥—ã"
            class="ore-icon"
          />
          <span id="ore-count" class="ore-count">0</span>
        </span>
        <span>
          <img
            src="https://img.icons8.com/ios-filled/50/4CAF50/lightning-bolt.png"
            alt="–ò–∫–æ–Ω–∫–∞ —ç–Ω–µ—Ä–≥–∏–∏"
            class="energy-icon"
          />
          <span id="energy-count" class="energy-count">100</span>
        </span>
      </div>

      <!-- –ü—Ä–æ—Ñ–∏–ª—å –∏–≥—Ä–æ–∫–∞ -->
      <div class="player-profile">
        <img
          id="user-avatar"
          src="https://img.icons8.com/ios-filled/50/user-male-circle.png"
          alt="–ê–≤–∞—Ç–∞—Ä –∏–≥—Ä–æ–∫–∞"
        />
        <div class="player-info">
          <div class="player-meta">
            <span class="player-name" id="user-name">–ò–≥—Ä–æ–∫</span> |
            <strong class="player-level">–£—Ä. 0</strong>
          </div>
          <div class="income">+0/—Å–µ–∫</div>
          <div class="progress-bar">
            <div class="progress-fill"></div>
          </div>
          <div class="energy-bar-container">
            <div class="energy-bar" id="energy-bar"></div>
          </div>
        </div>
      </div>

      <!-- –ü—Ä–æ—Ñ–∏–ª—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
      <h3>–ü—Ä–æ—Ñ–∏–ª—å</h3>
      <div class="helper-card">
        <img
          id="user-avatar"
          src="https://img.icons8.com/ios-filled/50/user-male-circle.png"
          alt="–ê–≤–∞—Ç–∞—Ä"
        />
        <div class="helper-info">
          <strong id="user-name">–ò–≥—Ä–æ–∫</strong>
          <span>–£—Ä–æ–≤–µ–Ω—å: <span id="player-level">0</span></span>
          <span>–í—Å–µ–≥–æ –º–æ–Ω–µ—Ç: <span id="total-coins">0</span></span>
          <span>–í—Å–µ–≥–æ –≥–µ–º–æ–≤: <span id="total-gems">0</span></span>
          <!-- <span>–í—Å–µ–≥–æ —Ä—É–¥—ã: <span id="total-ore">0</span></span> -->
          <span>–í—Å–µ–≥–æ —Ç–∞–ø–æ–≤: <span id="total-taps">0</span></span>
        </div>
      </div>
      </section>

<section id="achievements" class="achievements-section">
  <h2>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
  <ul id="achievements-list" class="achievements-list">
    <!-- –ê—á–∏–≤–∫–∏ –±—É–¥—É—Ç –ø–æ–¥–≥—Ä—É–∂–µ–Ω—ã —Å—é–¥–∞ -->
  </ul>
</section>

<section id="leaderboard" class="leaderboard-section">
  <h2>üèÜ –õ–∏–¥–µ—Ä–±–æ—Ä–¥</h2>
  <button id="refresh-leaderboard">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
  <ul id="leaderboard-list" class="leaderboard-list">
    <li>–ó–∞–≥—Ä—É–∑–∫–∞...</li>
  </ul>
</section>
      <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
      <div class="bottom-nav">
        <a href="index.html" class="nav-button"><i class="fas fa-fish"></i></a>
        <a href="shop.html" class="nav-button"><i class="fas fa-store"></i></a>
        <a href="profile.html" class="nav-button active"
          ><i class="fas fa-user"></i
        ></a>
        <a href="map.html" class="nav-button"><i class="fas fa-map"></i></a>
      </div>
    </div>

    <script>
 

      //
      document.addEventListener("DOMContentLoaded", () => {
        const elements = {
          coinCount: document.getElementById("coin-count"),
          gemCount: document.getElementById("gem-count"),
          oreCount: document.getElementById("ore-count"),
          energyCount: document.getElementById("energy-count"),
          userName: document.getElementById("user-name"),
          userAvatar: document.getElementById("user-avatar"),
          playerLevel: document.getElementById("player-level"),
          progressFill: document.getElementById("progress-fill"),
          totalCoins: document.getElementById("total-coins"),
          totalGems: document.getElementById("total-gems"),
          totalOre: document.getElementById("total-ore"),
          criticalHits: document.getElementById("critical-hits"),
          energySpent: document.getElementById("energy-spent"),
          totalTaps: document.getElementById("total-taps"),
          achievementsList: document.getElementById("achievements-list"),
        };
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        function updateAchievements(state) {
          achievementsList.innerHTML = ""; // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫
        }

        function formatNumber(num) {
          if (num < 1e3) return num.toString();
          if (num < 1e6)
            return (num / 1e3).toFixed(1).replace(/\.0$/, "") + "k";
          return (num / 1e6).toFixed(1).replace(/\.0$/, "") + "M";
        }

        function updateUI(state) {
          if (!state) return;

          // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∞–ª—é—Ç—ã
          if (elements.coinCount)
            elements.coinCount.textContent = formatNumber(
              state.currencies.coin
            );
          if (elements.gemCount)
            elements.gemCount.textContent = formatNumber(state.currencies.gem);
          if (elements.oreCount)
            elements.oreCount.textContent = formatNumber(state.currencies.ore);
          if (elements.energyCount)
            elements.energyCount.textContent = state.energy.current;

          // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
          if (elements.userName)
            elements.userName.textContent = state.player.name || "–ò–≥—Ä–æ–∫";
          if (elements.userAvatar)
            elements.userAvatar.src =
              state.player.avatarUrl ||
              "https://img.icons8.com/ios-filled/50/user-male-circle.png";
          if (elements.playerLevel)
            elements.playerLevel.textContent = `–£—Ä. ${state.player.level}`;
          if (elements.progressFill)
            elements.progressFill.style.width = `${state.player.progress}%`;

          // –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
          if (elements.totalCoins)
            elements.totalCoins.textContent = formatNumber(state.totals.coins);
          if (elements.totalGems)
            elements.totalGems.textContent = formatNumber(state.totals.gems);
          if (elements.totalOre)
            elements.totalOre.textContent = formatNumber(state.totals.ore);
          if (elements.criticalHits)
            elements.criticalHits.textContent = state.stats.criticalHits;
          if (elements.energySpent)
            elements.energySpent.textContent = state.stats.energySpent;
          if (elements.totalTaps)
            elements.totalTaps.textContent = formatNumber(state.totals.taps);

          // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
          if (elements.achievementsList) {
            elements.achievementsList.innerHTML = "";
            for (const id in window.config.achievements) {
              const configAchievement = window.config.achievements[id];
              const stateAchievement = state.achievements[id] || {
                unlocked: false,
              };

              const achievementDiv = document.createElement("div");
              achievementDiv.className = `achievement ${
                stateAchievement.unlocked ? "unlocked" : "locked"
              } helper-card`;

              let iconElement;
              if (stateAchievement.unlocked) {
                iconElement = document.createElement("img");
                iconElement.src = "https://img.icons8.com/color/96/trophy.png";
                iconElement.alt = "–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è";
                iconElement.style.width = "32px";
                iconElement.style.height = "32px";
                iconElement.style.marginRight = "10px";
              } else {
                iconElement = document.createElement("i");
                iconElement.className = "fas fa-lock";
                iconElement.style.marginRight = "10px";
              }

              const textDiv = document.createElement("div");
              textDiv.className = "achievement-text helper-info";

              const title = document.createElement("h4");
              title.textContent = configAchievement.name;

              const description = document.createElement("p");
              description.textContent = configAchievement.description;

              textDiv.appendChild(title);
              textDiv.appendChild(description);

              achievementDiv.appendChild(iconElement);
              achievementDiv.appendChild(textDiv);
              elements.achievementsList.appendChild(achievementDiv);
            }
          }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        const initialState = window.eventBus.emitSync("state:get");
        if (initialState) {
          updateUI(initialState);
        }

        // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        window.eventBus.on("state:updated", (newState) => {
          updateUI(newState);
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∏–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        const style = document.createElement("style");
        style.textContent = `
            .bg-green-900 { background-color: #0A5F0D; }
            .text-yellow-500 { color: #FFD700; }
          `;
        document.head.appendChild(style);
      });
    </script>
  </body>
</html>
